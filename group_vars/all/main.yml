---
# Install mode: dev, full, or minimal
install_mode: dev

# Install GUI apps (decoupled from mode)
install_gui: true

# Target user configuration
target_user: "{{ ansible_facts['user_id'] }}"
target_group: "{{ 'staff' if ansible_facts['os_family'] == 'Darwin' else ansible_facts['user_id'] }}"
target_home: "{{ ansible_facts['env']['HOME'] }}"

# Directory structure
user_directories:
  - "{{ target_home }}/.local/bin"
  - "{{ target_home }}/.local/share"
  - "{{ target_home }}/.local/etc"
  - "{{ target_home }}/.local/src"
  - "{{ target_home }}/Workspace/Projects"

# Container detection
is_container: >-
  {{ ansible_facts.get('virtualization_role', '') == 'guest'
     and ansible_facts.get('virtualization_type', '') in ['docker', 'container', 'lxc', 'podman', 'containerd'] }}

# Feature flags â€” controlled by install_mode
install_homebrew: true
install_nix: false
install_mise: true
install_docker: "{{ install_mode in ['minimal', 'dev', 'full'] and not (is_container | bool) }}"

# Essential packages
essential_packages:
  common:
    - curl
    - wget
    - git
    - zsh
    - unzip
    - tar
  debian:
    - build-essential
    - libssl-dev
    - libffi-dev
    - python3
    - python3-pip
    - ca-certificates
    - gnupg
    - lsb-release
    - apt-transport-https
  fedora:
    - gcc
    - gcc-c++
    - make
    - openssl-devel
    - libffi-devel
    - python3
    - python3-pip
    - ca-certificates
    - gnupg2
  arch:
    - base-devel
    - openssl
    - python
    - python-pip
  alpine:
    - build-base
    - openssl-dev
    - libffi-dev
    - python3
    - py3-pip
    - shadow
  darwin: []

# Chezmoi configuration
chezmoi_repo: "gplancke"
chezmoi_age_recipient: "age18948d9cjp3teqz57kc92gcwrj75dmxjzvvr5phvu58j3l8ndjghqk68hd5"
